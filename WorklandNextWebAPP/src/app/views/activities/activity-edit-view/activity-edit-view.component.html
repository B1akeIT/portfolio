<div class="flex-layout-header flex-column">
  <div class="bg-gray-100-" style="width: 100%;">
    <div class="d-flex flex-row justify-content-between">
      <div class="colo-xs-12 col-sm-6 pl-0 pr-0">
        <div class="float-left mr-1">
          <div class="btn-group btn-group-sm">
            <label class="btn btn-outiline-secondary" (click)="closeEdit($event)" style="padding-top: 0.7em;"> <!-- tooltip="{{ 'APP.TOOLTIP.back_panel' | translate }}" placement="right" container="body"  -->
              <i class="icon-arrow-left fa-lg"></i>
            </label>
          </div>
        </div>
        <div class="float-left mr-2" style="padding: 0.5em 0.40rem !important">
          <ion-icon class="" name="wallet-outline"></ion-icon> <span class="d-sm-none d-md-inline-block">{{ 'APP.TITLE.quote' | translate }}</span>
        </div>
        <div class="float-left- mr-2 text-truncate font-weight-bold" style="padding: 0.5em 0.40rem !important;" *ngIf="!loading">
          <span class="mr-3" *ngIf="!wQuote?.id && !error">{{ 'APP.TITLE.new_quote' | translate }}</span>
          <span class="h5 text-truncate" *ngIf="wQuote?.id || wQuote?.titolo || error" title="{{ wQuote?.id || quoteId }}">
            <span>{{ wQuote?.numero }}</span> - <span>{{ wQuote?.titolo }}</span>
          </span>
          <span class="small text-muted ml-3" *ngIf="wQuote?.id">
            {{ wQuote?.nominativoIntestatario }}
          </span>
        </div>
      </div>
      <div class="col-3 pl-0 pr-0 d-sm-none d-md-inline-block">
        <div class="text-center" style="padding: 0.5em 0.40rem !important;">
        </div>
        <!-- <div class="buttons-bar float-right">
          <div class="btn-toolbar" role="toolbar" style="padding: 0.20em 0.25rem !important">
            <div class="btn-group btn-group-sm">
              <span class="muted mr-2" style="margin-top: 0.3em;">1 di 400</span>
              <label class="btn btn-outline-info- mr-2" (click)="nextElement($event)" tooltip="{{ 'APP.TOOLTIP.next' | translate }}" placement="bottom" container="body">
                <i class="icon-arrow-left fa-1x"></i>
              </label>
              <label class="btn btn-outline-info-" (click)="prevElement($event)" tooltip="{{ 'APP.TOOLTIP.prev' | translate }}" placement="bottom" container="body">
                <i class="icon-arrow-right fa-1x"></i>
              </label>
            </div>
          </div>
        </div> -->
      </div>
      <div class="col-3 pl-0 pr-0 d-sm-none d-md-inline-block">
        <!-- <div class="btn-toolbar float-right" role="toolbar" style="padding: 0.5em 0.40rem !important">
          <div class="btn-group btn-group-sm">
            <span class="muted mr-2" style="margin-top: 0.3em;">1 di 400</span>
            <label class="btn btn-outline-info- mr-2" (click)="nextElement($event)" tooltip="{{ 'APP.TOOLTIP.next' | translate }}" placement="bottom" container="body">
              <i class="icon-arrow-left fa-1x"></i>
            </label>
            <label class="btn btn-outline-info-" (click)="prevElement($event)" tooltip="{{ 'APP.TOOLTIP.prev' | translate }}" placement="bottom" container="body">
              <i class="icon-arrow-right fa-1x"></i>
            </label>
          </div>
        </div> -->
        <!-- <div class="buttons-bar float-right">
          <div class="btn-toolbar" role="toolbar" style="padding: 0.20em 0.25rem !important">
            <div class="btn-group btn-group-sm">
              <label class="btn btn-outline-secondary-" (click)="closeEdit()" tooltip="{{ 'APP.TOOLTIP.close_panel' | translate }}" placement="left" container="body" style="padding-top: 0.5em;">
                <i class="cui-x fa-lg"></i>
              </label>
            </div>
          </div>
        </div> -->
        <!-- <div class="buttons-bar float-right">
          <div class="btn-toolbar" role="toolbar" style="padding: 0.20em 0.25rem !important">
            <div class="btn-group btn-group-sm">
              <label class="btn btn-outline-info-" (click)="toggleSidebar($event)" [class.text-info]="sidebarOpened" tooltip="{{ 'APP.TOOLTIP.show_hide_help' | translate }}" placement="left" container="body">
                <i class="icon-question fa-lg"></i>
              </label>
            </div>
          </div>
        </div> -->
        <div class="buttons-bar float-right" *ngIf="wQuote?.id">
          <div class="btn-toolbar" role="toolbar" style="padding: 0.15em 0.25rem !important">
            <div class="btn-group btn-group-sm mx-1">
              <a class="btn btn-outline-secondary"
                tooltip="{{ 'APP.TOOLTIP.delete' | translate }}"
                container="body"
                mwlConfirmationPopover
                [popoverTitle]="'APP.TITLE.delete' | translate"
                [popoverMessage]="'APP.MESSAGE.are_you_sure' | translate"
                [cancelText]="'APP.BUTTON.cancel' | translate"
                [cancelButtonType]="'outline-secondary btn-sm'"
                [confirmText]="'APP.BUTTON.confirm' | translate"
                [confirmButtonType]="'danger btn-sm'"
                [appendToBody]="true"
                placement="left"
                (confirm)="onDelete(true)">
                <i class="icon-trash"></i></a>
            </div>
            <div class="btn-group btn-group-sm mr-1">
              <button class="btn btn-outline-secondary" (click)="onCopy()"
                tooltip="{{ 'APP.TOOLTIP.copy' | translate }}" placement="left" container="body">
                <i class="cui-copy"></i></button>
              <button class="btn btn-outline-secondary" (click)="onCreateOrder()" [disabled]="!isClient()"
                tooltip="{{ 'APP.TOOLTIP.create_order' | translate }}" placement="left" container="body">
                <i class="cui-cart"></i></button>
            </div>
            <div class="btn-group btn-group-sm">
              <button class="btn btn-outline-secondary" tooltip="{{ 'APP.TOOLTIP.print' | translate }}" placement="left" container="body">
                <i class="cui-print fa-lg"></i> <span class="d-none">{{ 'APP.BUTTON.print' | translate }}</span>
              </button>
            </div>
          </div>
        </div>
        <div class="float-right mr-2" style="padding: 0.5em 0.40rem !important;" *ngIf="!loading">
          <span class="badge badge-warning rounded-pill" style="font-size: 0.9em;" *ngIf="!wQuote?.id">{{ 'APP.MESSAGE.not_saved' | translate }}</span>
          <span class="badge badge-warning rounded-pill" style="font-size: 0.9em;" *ngIf="wQuote?.id && modified">{{ 'APP.MESSAGE.modified' | translate }}</span>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="flex-layout-body" style="overflow: auto;height: calc( 100% - 40px - 40px );">
  <div class="flex-layout-content" appFit>
    <ngx-loading
      [show]="loading"
      [config]="loadingOptions">
    </ngx-loading>
    <div class="bg-gray-100-" [ngStyle]="{ 'border-bottom': '1px solid #cfd8dc', 'height': offsetLayout }" *ngIf="!loading && wQuote">
      <div class="d-flex flex-row justify-content-center px-3" *ngIf="!loading">
        <mat-tab-group mat-align-tabs="left" class="col-12 px-0" (selectedTabChange)="onSelectMatTabChange($event)">
          <ng-container *ngFor="let panel of panels;let idx = index;">
            <ng-template [appHasPermission]="panel.permission" [action]="'view'" [owner]="false">
              <mat-tab label="{{ panel.title | translate }}" [disabled]="isTabDisabled(panel)"></mat-tab>
            </ng-template>
          </ng-container>
        </mat-tab-group>
      </div>
    </div>
    <div class="layout-content quote-container" *ngIf="error">
      <div class="text-center py-3">
        <div class="h1 text-muted text-center mt-5 mb-1">
          <h5>{{ errorMessage }}</h5>
        </div>
      </div>
    </div>
    <div class="layout-content quote-container custom-scroll" [ngStyle]="{ 'width': 'calc( 100% )', 'height': 'calc( 100% - ' + offsetLayout + ')' }" *ngIf="!error">
      <div class="tab-content- mx-0" style="width: calc( 100% );" *ngIf="!loading && wQuote">
        <div class="container-fluid tab-pane fadeIn pt-0 px-2 px-sm-3" id="general_info">
          <form #quoteForm="ngForm" class="form-horizontal" (change)="onFormChanges($event)" autocomplete="off">
            <div class="form-row align-items-start" style="min-height: 555px;">
              <div class="form-group col-12 mb-0">
                <!-- <mat-tab-group mat-align-tabs="left" class="px-0"> -->
                  <div class="container-fluid tab-pane fadeIn pt-3 px-2 px-sm-3 mb-3" id="header" [hidden]="!isTabActive('header')">
                  <!-- <mat-tab label="{{ 'APP.TAB.header' | translate }}"> -->
                    <div class="form-row align-items-start mb-1">
                      <div class="form-group col-6 mb-0">
                        <div class="card card-client-info mx-auto pt-0 mb-2">
                          <div class="card-body px-2 pt-0 pb-1">
                            <div class="d-flex flex-row justify-content-center px-0">
                              <mat-tab-group mat-align-tabs="left" class="col-12 px-0 tab-custom-content">
                                <mat-tab label="{{ 'Intestatario' | translate }}">
                                  <div class="block-intestatario">
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('contattoIntestatarioId')" for="contattoIntestatarioId">{{ 'APP.FIELD.contattoIntestatarioId' | translate }}</label>
                                        <input type="text" name="contattoIntestatarioId" class="form-control form-control-sm mb-1-" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.contattoIntestatarioId" readonly>
                                      </div>
                                      <div class="form-group input-group input-group-sm col-10 mb-0">
                                        <label class="col-form-label col-form-label-sm w-100" [class.modified-]="isModifiedProperty('nominativoIntestatario')" for="nominativoIntestatario">{{ 'APP.FIELD.empty' | translate }}&nbsp; <span class="btn btn-sm p-0 float-right" style="font-size: 0.9em;" (click)="openChoiceModal('intestatario')"><i class="icon-magnifier"></i></span></label>
                                        <input type="text" name="nominativoIntestatario" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.nominativoIntestatario" readonly>
                                        <div class="input-group-append cursor-pointer" (click)="showContact(wQuote.contattoIntestatarioId, wQuote.nominativoIntestatario)" *ngIf="wQuote.contattoIntestatarioId"><span class="input-group-text"><i class="icon-eye"></i></span></div>
                                      </div>
                                      <!-- <div class="form-group col-12 my-0">
                                        <ng-select class="form-select-sm"
                                          name="contattoIntestatarioId"
                                          appendTo="body"
                                          bindValue="id"
                                          bindLabel="ragioneSociale"
                                          [items]="contacts$ | async"
                                          [trackByFn]="trackByContacts"
                                          [placeholder]="'APP.MESSAGE.choose_clienteIntestatario' | translate"
                                          [minTermLength]="minLengthTerm"
                                          [loading]="contactsLoading"
                                          [loadingText]="'APP.MESSAGE.loading' | translate"
                                          [notFoundText]="'APP.MESSAGE.no_items_found' | translate"
                                          [typeToSearchText]="'APP.MESSAGE.limit_lenght_term' | translate:minTranslateParams"
                                          [typeahead]="contactsInput$"
                                          [(ngModel)]="wQuote.contattoIntestatarioId"
                                          (change)="onChangeContact('intestatario', $event)">
                                            <ng-template ng-option-tmp let-item="item">
                                              {{item.ragioneSociale}}
                                              <br/> <small>{{item.nome}} {{item.cognome}} - {{item.id}}</small>
                                            </ng-template>
                                        </ng-select>
                                      </div> -->
                                    </div>
                                    <div class="form-row align-items-center" *ngIf="wQuote.unitaId">
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('clienteProprietarioId')" for="contattoIntestatarioId">{{ 'APP.FIELD.clienteProprietarioId' | translate }}</label>
                                        <input type="text" name="clienteProprietarioId" class="form-control form-control-sm mb-1-" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.clienteProprietarioId" readonly>
                                      </div>
                                      <div class="form-group input-group input-group-sm col-10 mb-0">
                                        <label class="col-form-label col-form-label-sm w-100" [class.modified-]="isModifiedProperty('nominativoProprietario')" for="nominativoProprietario">{{ 'APP.FIELD.empty' | translate }}&nbsp;</label>
                                        <input type="text" name="nominativoProprietario" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.nominativoProprietario" readonly>
                                        <div class="input-group-append cursor-pointer" (click)="showContact(wQuote.clienteProprietarioId, wQuote.nominativoProprietario)" *ngIf="wQuote.nominativoProprietario"><span class="input-group-text"><i class="icon-eye"></i></span></div>
                                      </div>
                                    </div>
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-12 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('indirizzoIntestatario')" for="indirizzoIntestatario">{{ 'APP.FIELD.indirizzo' | translate }}</label>
                                        <input type="text" name="indirizzoIntestatario" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.indirizzo' | translate }}" [(ngModel)]="wQuote.indirizzoIntestatario" readonly>
                                      </div>
                                    </div>
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('capIntestatario')" for="capIntestatario">{{ 'APP.FIELD.cap' | translate }}</label>
                                        <input type="text" name="capIntestatario" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.cap' | translate }}" [(ngModel)]="wQuote.capIntestatario" readonly>
                                      </div>
                                      <div class="form-group col-5 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('comuneIntestatario')" for="comuneIntestatario">{{ 'APP.FIELD.comune' | translate }}</label>
                                        <input type="text" name="comuneIntestatario" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.comune' | translate }}" [(ngModel)]="wQuote.comuneIntestatario" readonly>
                                      </div>
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('provinciaIntestatario')" for="provinciaIntestatario">{{ 'APP.FIELD.provincia' | translate }}</label>
                                        <input type="text" name="provinciaIntestatario" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.provincia' | translate }}" [(ngModel)]="wQuote.provinciaIntestatario" readonly>
                                      </div>
                                      <div class="form-group col-3 mb-0">
                                        <label class="col-form-label col-form-label-sm w-100" [class.modified]="isModifiedProperty('nazioneIntestatario')" for="nazioneIntestatario" title="{{ wQuote.nazioneIntestatario }}">{{ 'APP.FIELD.nazione' | translate }}</label>
                                        <input type="text" name="nazioneIntestatario" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.nazione' | translate }}" [(ngModel)]="wQuote.nazioneIntestatario" readonly>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="form-row mt-3">
                                    <div class="form-group form-check col-8 mb-0">
                                      <label class="form-check-label col-form-label-sm" for="isStessoFatturazione">{{ 'APP.FIELD.isStessoFatturazione' | translate }}</label>
                                      <!-- <input type="checkbox" name="isStessoFatturazione" class="form-control form-check-input form-control-sm-" [(ngModel)]="wQuote.isStessoFatturazione"> --><br>
                                      <label class="switch switch-sm switch-3d switch-primary">
                                        <input type="checkbox" name="isStessoFatturazione" [checked]="wQuote.isStessoFatturazione" class="switch-input" [(ngModel)]="wQuote.isStessoFatturazione">
                                        <span class="switch-slider"></span>
                                      </label>
                                    </div>
                                    <div class="form-group col-4 mb-0">

                                    </div>
                                  </div>
                                  <div class="card card-client-info mx-auto mb-0 mt-2">
                                    <div class="card-body px-2 py-2">
                                      <app-emails-list [contactId]="wQuote.contattoIntestatarioId" [small]="true"></app-emails-list>
                                    </div>
                                  </div>
                                </mat-tab>
                                <mat-tab label="{{ 'Fatturazione' | translate }}" [disabled]="wQuote.isStessoFatturazione">
                                  <div class="block-fatturazione">
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('clienteFatturazioneId')" for="clienteFatturazioneId">{{ 'APP.FIELD.clienteFatturazioneId' | translate }}</label>
                                        <input type="text" name="clienteFatturazioneId" class="form-control form-control-sm mb-1" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.clienteFatturazioneId" readonly>
                                      </div>
                                      <div class="form-group input-group input-group-sm col-10 mb-0">
                                        <label class="col-form-label col-form-label-sm w-100" [class.modified-]="isModifiedProperty('nominativoFatturazione')" for="nominativoFatturazione">{{ 'APP.FIELD.empty' | translate }}&nbsp; <span class="btn btn-sm p-0 float-right" style="font-size: 0.9em;" (click)="openChoiceModal('fatturazione')"><i class="icon-magnifier"></i></span></label>
                                        <input type="text" name="nominativoFatturazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.nominativoFatturazione" readonly>
                                        <div class="input-group-append cursor-pointer" (click)="showContact(wQuote.clienteFatturazioneId, wQuote.nominativoFatturazione)" *ngIf="wQuote.clienteFatturazioneId"><span class="input-group-text"><i class="icon-eye"></i></span></div>
                                      </div>
                                      <!-- <div class="form-group col-12 my-0">
                                        <ng-select class="form-select-sm"
                                          name="clienteFatturazioneId"
                                          appendTo="body"
                                          bindValue="id"
                                          bindLabel="ragioneSociale"
                                          [items]="contacts$ | async"
                                          [trackByFn]="trackByContacts"
                                          [placeholder]="'APP.MESSAGE.choose_clienteFatturazione' | translate"
                                          [minTermLength]="minLengthTerm"
                                          [loading]="contactsLoading"
                                          [loadingText]="'APP.MESSAGE.loading' | translate"
                                          [notFoundText]="'APP.MESSAGE.no_items_found' | translate"
                                          [typeToSearchText]="'APP.MESSAGE.limit_lenght_term' | translate:minTranslateParams"
                                          [typeahead]="contactsInput$"
                                          [(ngModel)]="wQuote.clienteFatturazioneId"
                                          (change)="onChangeContact('fatturazione', $event)">
                                            <ng-template ng-option-tmp let-item="item">
                                              {{item.ragioneSociale}} <br/>
                                              <small>{{item.nome}} {{item.cognome}} - {{item.id}}</small>
                                            </ng-template>
                                        </ng-select>
                                      </div> -->
                                    </div>
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-12 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('indirizzoFatturazione')" for="indirizzoFatturazione">{{ 'APP.FIELD.indirizzo' | translate }}</label>
                                        <input type="text" name="indirizzoFatturazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.indirizzo' | translate }}" [(ngModel)]="wQuote.indirizzoFatturazione" readonly>
                                      </div>
                                    </div>
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('capFatturazione')" for="capFatturazione">{{ 'APP.FIELD.cap' | translate }}</label>
                                        <input type="text" name="capFatturazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.cap' | translate }}" [(ngModel)]="wQuote.capFatturazione" readonly>
                                      </div>
                                      <div class="form-group col-5 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('comuneFatturazione')" for="comuneFatturazione">{{ 'APP.FIELD.comune' | translate }}</label>
                                        <input type="text" name="comuneFatturazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.comune' | translate }}" [(ngModel)]="wQuote.comuneFatturazione" readonly>
                                      </div>
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('provinciaFatturazione')" for="provinciaFatturazione">{{ 'APP.FIELD.provincia' | translate }}</label>
                                        <input type="text" name="provinciaFatturazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.provincia' | translate }}" [(ngModel)]="wQuote.provinciaFatturazione" readonly>
                                      </div>
                                      <div class="form-group col-3 mb-0">
                                        <label class="col-form-label col-form-label-sm w-100" [class.modified]="isModifiedProperty('nazioneFatturazione')" for="nazioneFatturazione" title="{{ wQuote.nazioneFatturazione }}">{{ 'APP.FIELD.nazione' | translate }}</label>
                                        <input type="text" name="nazioneFatturazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.nazione' | translate }}" [(ngModel)]="wQuote.nazioneFatturazione" readonly>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="card card-client-info mx-auto mb-0 mt-4">
                                    <div class="card-body px-2 py-2">
                                      <app-emails-list [contactId]="wQuote.clienteFatturazioneId" [small]="true"></app-emails-list>
                                    </div>
                                  </div>
                                </mat-tab>
                                <mat-tab label="{{ 'Destinazione' | translate }}">
                                  <div class="block-destinazione">
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('contattoDestinazioneId')" for="contattoDestinazioneId">{{ 'APP.FIELD.contattoDestinazioneId' | translate }}</label>
                                        <input type="text" name="contattoDestinazioneId" class="form-control form-control-sm mb-1" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.contattoDestinazioneId" readonly>
                                      </div>
                                      <div class="form-group input-group input-group-sm col-10 mb-0">
                                        <label class="col-form-label col-form-label-sm w-100" [class.modified-]="isModifiedProperty('nominativoDestinazione')" for="nominativoDestinazione">{{ 'APP.FIELD.empty' | translate }}&nbsp; <span class="btn btn-sm p-0 float-right" style="font-size: 0.9em;" (click)="openChoiceModal('destinazione')"><i class="icon-magnifier"></i></span></label>
                                        <input type="text" name="nominativoDestinazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.nominativoDestinazione">
                                        <div class="input-group-append cursor-pointer" (click)="showContact(wQuote.contattoDestinazioneId, wQuote.nominativoDestinazione)" *ngIf="wQuote.contattoDestinazioneId"><span class="input-group-text"><i class="icon-eye"></i></span></div>
                                      </div>
                                      <!-- <div class="form-group col-12 my-0">
                                        <ng-select class="form-select-sm"
                                          name="contattoDestinazioneId"
                                          appendTo="body"
                                          bindValue="id"
                                          bindLabel="ragioneSociale"
                                          [items]="contacts$ | async"
                                          [trackByFn]="trackByContacts"
                                          [placeholder]="'APP.MESSAGE.choose_clienteDestinazione' | translate"
                                          [minTermLength]="minLengthTerm"
                                          [loading]="contactsLoading"
                                          [loadingText]="'APP.MESSAGE.loading' | translate"
                                          [notFoundText]="'APP.MESSAGE.no_items_found' | translate"
                                          [typeToSearchText]="'APP.MESSAGE.limit_lenght_term' | translate:minTranslateParams"
                                          [typeahead]="contactsInput$"
                                          [(ngModel)]="wQuote.contattoDestinazioneId"
                                          (change)="onChangeContact('destinazione', $event)">
                                            <ng-template ng-option-tmp let-item="item">
                                              {{item.ragioneSociale}} <br/>
                                              <small>{{item.nome}} {{item.cognome}} - {{item.id}}</small>
                                            </ng-template>
                                        </ng-select>
                                      </div> -->
                                    </div>
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-12 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('indirizzoDestinazione')" for="indirizzoDestinazione">{{ 'APP.FIELD.indirizzo' | translate }}</label>
                                        <input type="text" name="indirizzoDestinazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.indirizzo' | translate }}" [(ngModel)]="wQuote.indirizzoDestinazione">
                                      </div>
                                    </div>
                                    <div class="form-row align-items-center">
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('capDestinazione')" for="capDestinazione">{{ 'APP.FIELD.cap' | translate }}</label>
                                        <input type="text" name="capDestinazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.cap' | translate }}" [(ngModel)]="wQuote.capDestinazione">
                                      </div>
                                      <div class="form-group col-5 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('comuneDestinazione')" for="comuneDestinazione">{{ 'APP.FIELD.comune' | translate }}</label>
                                        <input type="text" name="comuneDestinazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.comune' | translate }}" [(ngModel)]="wQuote.comuneDestinazione">
                                      </div>
                                      <div class="form-group col-2 mb-0">
                                        <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('provinciaDestinazione')" for="provinciaDestinazione">{{ 'APP.FIELD.provincia' | translate }}</label>
                                        <input type="text" name="provinciaDestinazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.provincia' | translate }}" [(ngModel)]="wQuote.provinciaDestinazione">
                                      </div>
                                      <div class="form-group col-3 mb-0">
                                        <label class="col-form-label col-form-label-sm w-100" [class.modified]="isModifiedProperty('nazioneDestinazione')" for="nazioneDestinazione" title="{{ wQuote.nazioneDestinazione }}">{{ 'APP.FIELD.nazione' | translate }} <span class="btn btn-sm p-0 float-right" (click)="tableMS.openTableModal('Nazione')"><i class="cui-pencil"></i></span></label>
                                        <ng-select class="form-select-sm"
                                          name="nazioneDestinazione"
                                          [items]="anagrafiche['AnagNazione']"
                                          bindValue="id"
                                          bindLabel="descrizione"
                                          appendTo="body"
                                          [loading]="nationLoading"
                                          [searchFn]="customSearchFn"
                                          [(ngModel)]="wQuote.nazioneDestinazione"
                                          (change)="onChangeNazione($event)">
                                            <ng-template ng-option-tmp let-item="item">
                                              {{item.descrizione}} <br/>
                                              <small>{{item.codice}} - {{item.id}}</small>
                                            </ng-template>
                                        </ng-select>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="card card-client-info mx-auto mb-0 mt-4">
                                    <div class="card-body px-2 py-2">
                                      <app-emails-list [contactId]="wQuote.contattoDestinazioneId" [small]="true"></app-emails-list>
                                    </div>
                                  </div>
                                </mat-tab>
                              </mat-tab-group>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="form-group col-6 mb-0">
                        <div class="card card-general-info mx-auto mb-2">
                          <div class="card-body px-2 pt-1">
                            <div class="form-row align-items-center">
                              <div class="form-group col-2 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('numero')" for="numero">{{ 'APP.FIELD.numero' | translate }}</label>
                                <input type="text" name="numero" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.numero' | translate }}" [(ngModel)]="wQuote.numero" [readonly]="wQuote.id">
                              </div>
                              <div class="form-group col-5 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('titolo')" for="titolo">{{ 'APP.FIELD.titolo' | translate }}</label>
                                <input type="text" name="titolo" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.titolo' | translate }}" [(ngModel)]="wQuote.titolo">
                              </div>
                              <div class="form-group col-5 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('referente')" for="referente">{{ 'APP.FIELD.referente' | translate }}</label>
                                <input type="text" name="referente" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.referente' | translate }}" [(ngModel)]="wQuote.referente">
                              </div>
                            </div>
                            <div class="form-row align-items-center">
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('anagTipoClienteId')" for="anagTipoClienteId">{{ 'APP.FIELD.tipoCliente' | translate }}</label>
                                <select name="anagTipoClienteId" class="form-control form-control-sm" [(ngModel)]="wQuote.anagTipoClienteId">
                                  <option [value]="tipoCli.id" *ngFor="let tipoCli of anagraficheCombo['SpComboTipoCliente'];">{{ tipoCli.descrizione }}</option>
                                </select>
                              </div>
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('dataCreazione')" for="dataCreazione">{{ 'APP.FIELD.dataCreazione' | translate }}</label>
                                <input type="date" name="dataCreazione" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.dataCreazione' | translate }}" [(ngModel)]="wQuote.dataCreazione">
                              </div>
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('dataScadenza')" for="dataScadenza">{{ 'APP.FIELD.dataScadenza' | translate }}</label>
                                <input type="date" name="dataScadenza" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.dataScadenza' | translate }}" [(ngModel)]="wQuote.dataScadenza">
                              </div>
                            </div>
                            <div class="form-row align-items-center">
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('riferimentoCliente')" for="riferimentoCliente">{{ 'APP.FIELD.riferimentoCliente' | translate }}</label>
                                <input type="text" name="riferimentoCliente" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.riferimentoCliente' | translate }}" [(ngModel)]="wQuote.riferimentoCliente">
                              </div>
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('riferimentoCommercialeId')" for="riferimentoCommerciale">{{
                                  'APP.FIELD.riferimentoCommerciale' | translate }}</label>
                                <select name="riferimentoCommercialeId" class="form-control form-control-sm" [(ngModel)]="wQuote.riferimentoCommercialeId">
                                  <option value="0">&nbsp;</option>
                                  <option [value]="comm.id" *ngFor="let comm of anagraficheCombo['SpComboUtente'];" (click)="onChangeField('riferimentoCommercialeId', comm)">{{ comm.descrizione }}</option>
                                </select>
                                <!-- <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('riferimentoCommerciale')" for="riferimentoCommerciale">{{ 'APP.FIELD.riferimentoCommerciale' | translate }}</label>
                                <input type="text" name="riferimentoCommerciale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.riferimentoCommerciale' | translate }}" [(ngModel)]="wQuote.riferimentoCommerciale"> -->
                              </div>
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('listinoId')" for="listinoId">{{ 'APP.FIELD.listinoId' | translate }}</label>
                                <select name="listinoId" class="form-control form-control-sm" [(ngModel)]="wQuote.listinoId">
                                  <option value="0">&nbsp;</option>
                                  <option [value]="listino.id" *ngFor="let listino of anagraficheCombo['SpComboListino'];">{{ listino.descrizione }}</option>
                                </select>
                              </div>
                            </div>
                            <div class="form-row align-items-center">
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('anagTipoPagamentoId')" for="anagTipoPagamentoId">{{ 'APP.FIELD.anagTipoPagamentoId' | translate }}</label>
                                <ng-select class="form-select-sm"
                                  name="anagTipoPagamentoId"
                                  [items]="anagraficheCombo['SpComboTipoPagamento']"
                                  bindValue="id"
                                  bindLabel="descrizione"
                                  appendTo="body"
                                  [loading]="otherLoading"
                                  [searchFn]="customSearchFn"
                                  [(ngModel)]="wQuote.anagTipoPagamentoId"
                                  (change)="onFormChanges($event)">
                                </ng-select>
                              </div>
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('anagDepartmentId')" for="anagDepartmentId">{{ 'APP.FIELD.anagDepartmentId' | translate }}</label>
                                <select name="anagDepartmentId" class="form-control form-control-sm" [(ngModel)]="wQuote.anagDepartmentId" (change)="onChangeDepartment($event)">
                                  <option value="0">&nbsp;</option>
                                  <option [value]="department.id" *ngFor="let department of anagraficheCombo['SpComboDepartment'];">{{ department.descrizione }}</option>
                                </select>
                              </div>
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('categoriaDocumentoId')" for="categoriaDocumentoId">{{ 'APP.FIELD.categoriaDocumentoId' | translate }}</label>
                                <select name="categoriaDocumentoId" class="form-control form-control-sm" [(ngModel)]="wQuote.categoriaDocumentoId">
                                  <option value="0">&nbsp;</option>
                                  <option [value]="categoria.id" *ngFor="let categoria of anagraficheCombo['SpComboCategoriaDocumento'];">{{ categoria.descrizione }}</option>
                                </select>
                              </div>
                            </div>
                            <div class="form-row align-items-center">
                              <div class="form-group col-4 mb-0">

                              </div>
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('statoDocumentoId')" for="statoDocumentoId">{{ 'APP.FIELD.statoDocumento' | translate }}</label>
                                <select name="statoDocumentoId" class="form-control form-control-sm" [(ngModel)]="wQuote.statoDocumentoId">
                                  <option [value]="statoDoc.id" *ngFor="let statoDoc of anagrafiche['statoDocumento'];">{{ statoDoc.descrizione }}</option>
                                </select>
                              </div>
                              <div class="form-group col-4 mb-0">
                                <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('valutaDiRedazioneId')" for="valutaDiRedazioneId">{{ 'APP.FIELD.valutaDiRedazione' | translate }}</label>
                                <select name="valutaDiRedazioneId" class="form-control form-control-sm" [(ngModel)]="wQuote.valutaDiRedazioneId">
                                  <option value="0">&nbsp;</option>
                                  <option [value]="currencie.id" *ngFor="let currencie of anagraficheCombo['SpComboValuta'];">{{ currencie.descrizione }}</option>
                                </select>
                              </div>
                            </div>
                            <div class="form-row align-items-center mt-2">
                              <div class="form-group col-12 mb-0">
                                <fieldset class="fieldset-border">
                                  <legend class="small">{{ 'Dati Fiscali' | translate }}</legend>
                                  <div class="form-row align-items-center">
                                    <div class="form-group col-6 mb-0">
                                      <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('codiceFiscale')" for="stato">{{ 'APP.FIELD.codiceFiscale' | translate }}</label>
                                      <input type="text" name="codiceFiscale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.codiceFiscale' | translate }}" [(ngModel)]="wQuote.codiceFiscale" readonly>
                                    </div>
                                    <div class="form-group col-6 mb-0">
                                      <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('piva')" for="stato">{{ 'APP.FIELD.piva' | translate }}</label>
                                      <input type="text" name="piva" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.piva' | translate }}" [(ngModel)]="wQuote.piva" readonly>
                                    </div>
                                  </div>
                                  <div class="form-row align-items-center">
                                    <div class="form-group col-3 mb-0">
                                      <label class="col-form-label col-form-label-sm" for="isEsenteIva">{{ 'APP.PLACEHOLDER.isEsenteIva' | translate }}</label>
                                      <input type="checkbox" name="isEsenteIva" class="d-block form-control-sm" [(ngModel)]="wQuote.isEsenteIva">
                                    </div>
                                    <div class="form-group col-9 mb-0">
                                      <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('anagIvaId')" for="stato">{{ 'APP.FIELD.iva' | translate }}</label>
                                      <ng-select class="form-select-sm" [disabled]="!wQuote.isEsenteIva"
                                        name="anagIvaId"
                                        [items]="anagraficheCombo['SpComboIva']"
                                        bindValue="id"
                                        bindLabel="descrizione"
                                        appendTo="body"
                                        [searchFn]="customSearchFn"
                                        [(ngModel)]="wQuote.anagIvaId"
                                        (change)="onFormChanges($event)">
                                          <ng-template ng-option-tmp let-item="item">
                                            {{item.descrizione}} <br/>
                                            <small>{{item.codice}} - {{item.id}}</small>
                                          </ng-template>
                                      </ng-select>
                                    </div>
                                  </div>
                                </fieldset>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <fieldset class="fieldset-border fieldset-textarea">
                      <legend class="small">{{ 'Note interne' | translate }}</legend>
                      <div class="form-row align-items-center">
                        <div class="form-group col-12 mb-0">
                          <textarea class="form-control form-control-sm" name="noteInterne" rows="6" [(ngModel)]="wQuote.noteInterne" autocomplete="off"></textarea>
                        </div>
                      </div>
                    </fieldset>
                  <!-- </mat-tab> -->
                  </div>
                  <div class="container-fluid tab-pane fadeIn pt-3 px-2 px-sm-3" id="body" [hidden]="!isTabActive('body')">
                  <!-- <mat-tab label="{{ 'APP.TAB.body' | translate }}"> -->
                    <div class="card card-client-info mx-auto">
                      <div class="card-body px-0 py-0">
                        <app-quote-body
                          [quoteId]="wQuote.id"
                          [clientId]="wQuote.isStessoFatturazione ? wQuote.clienteIntestatarioId : wQuote.clienteFatturazioneId"
                          [sortable]="true"
                          [filter]="false"
                          [editable]="true"
                          [testataModified]="modified"
                          [options]="{ height: '450px' }"
                          (save)="onQuoteBodySave($event)"
                          (delete)="onQuoteBodyDelete($event)"
                        ></app-quote-body>
                      </div>
                    </div>
                  <!-- </mat-tab> -->
                  </div>
                  <div class="container-fluid tab-pane fadeIn pt-3 px-2 px-sm-3" id="message" [hidden]="!isTabActive('message')">
                  <!-- <mat-tab label="{{ 'APP.TAB.message' | translate }}"> -->
                    <div class="card card-client-info mx-auto">
                      <div class="card-body px-2 py-2">
                        <!-- <div class="d-flex flex-row justify-content-center px-0">
                          <div class="py-5">{{ 'APP.TAB.message' | translate }}</div>
                        </div> -->
                        <div class="form-row align-items-center">
                          <div class="form-group col-6 mb-0">
                            <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('noteTestata1')" for="noteTestata1">{{ 'APP.FIELD.noteTestata1' | translate }}</label>
                            <textarea class="form-control form-control-sm" name="noteTestata1" rows="8" [(ngModel)]="wQuote.noteTestata1" autocomplete="off"></textarea>
                          </div>
                          <div class="form-group col-6 mb-0">
                            <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('noteTestata2')" for="noteTestata2">{{ 'APP.FIELD.noteTestata2' | translate }}</label>
                            <textarea class="form-control form-control-sm" name="noteTestata2" rows="8" [(ngModel)]="wQuote.noteTestata2" autocomplete="off"></textarea>
                          </div>
                        </div>
                        <div class="form-row align-items-center">
                          <div class="form-group col-6 mb-0">
                            <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('sezione1DopoCorpo')" for="sezione1DopoCorpo">{{ 'APP.FIELD.sezione1DopoCorpo' | translate }}</label>
                            <textarea class="form-control form-control-sm" name="sezione1DopoCorpo" rows="8" [(ngModel)]="wQuote.sezione1DopoCorpo" autocomplete="off"></textarea>
                          </div>
                          <div class="form-group col-6 mb-0">
                            <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('sezione2DopoCorpo')" for="sezione2DopoCorpo">{{ 'APP.FIELD.sezione2DopoCorpo' | translate }}</label>
                            <textarea class="form-control form-control-sm" name="sezione2DopoCorpo" rows="8" [(ngModel)]="wQuote.sezione2DopoCorpo" autocomplete="off"></textarea>
                          </div>
                        </div>
                      </div>
                    </div>
                  <!-- </mat-tab> -->
                  </div>
                  <div class="container-fluid tab-pane fadeIn pt-3 px-2 px-sm-3" id="footer" [hidden]="!isTabActive('footer')">
                  <!-- <mat-tab label="{{ 'APP.TAB.footer' | translate }}"> -->
                    <div class="card card-client-info mx-auto">
                      <div class="card-body pt-2 pb-4 py-2">
                        <div class="px-0">
                          <div class="form-row align-items-center">
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('scontoValore')" for="scontoValore">{{ 'APP.FIELD.scontoValore' | translate }}</label>
                              <input type="number" name="scontoValore" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.scontoValore' | translate }}" [(ngModel)]="wQuote.scontoValore">
                            </div>
                            <div class="form-group col-1 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('scontoPercentuale')" for="scontoPercentuale">{{ 'APP.FIELD.scontoPercentuale' | translate }}</label>
                              <input type="number" name="scontoPercentuale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.scontoPercentuale' | translate }}" [(ngModel)]="wQuote.scontoPercentuale">
                            </div>
                            <div class="col-9 mb-0">
                              <fieldset class="form-row fieldset-border fieldset-textarea">
                                <legend class="small">{{ 'Extra Fido' | translate }}</legend>
                                <div class="form-group col-3 mb-1">
                                  <label class="form-check-label col-form-label-sm d-block" [class.modified]="isModifiedProperty('extraFido')" for="extraFido">{{ 'APP.FIELD.extraFido' | translate }}</label>
                                  <!-- <input type="text" name="extraFido" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.extraFido' | translate }}" [(ngModel)]="wQuote.extraFido"> -->
                                  <label class="switch switch-sm switch-3d switch-primary">
                                    <input type="checkbox" name="extraFido" [checked]="wQuote.extraFido" class="switch-input" [(ngModel)]="wQuote.extraFido">
                                    <span class="switch-slider"></span>
                                  </label>
                                </div>
                                <div class="form-group col-3 mb-1">
                                  <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('importoExtra')" for="importoExtra">{{ 'APP.FIELD.importoExtra' | translate }}</label>
                                  <input type="number" name="importoExtra" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.importoExtra' | translate }}" [(ngModel)]="wQuote.importoExtra" [disabled]="!wQuote.extraFido">
                                </div>
                              </fieldset>
                            </div>
                          </div>
                          <div class="form-row align-items-center">
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('costoTrasportoValore')" for="costoTrasportoValore">{{ 'APP.FIELD.costoTrasportoValore' | translate }}</label>
                              <input type="number" name="costoTrasportoValore" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.costoTrasportoValore' | translate }}" [(ngModel)]="wQuote.costoTrasportoValore">
                            </div>
                            <div class="form-group col-1 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('costoTrasportoPercentuale')" for="costoTrasportoPercentuale">{{ 'APP.FIELD.costoTrasportoPercentuale' | translate }}</label>
                              <input type="number" name="costoTrasportoPercentuale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.costoTrasportoPercentuale' | translate }}" [(ngModel)]="wQuote.costoTrasportoPercentuale">
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('trasportoTotale')" for="trasportoTotale">{{ 'APP.FIELD.trasportoTotale' | translate }}</label>
                              <input type="number" name="trasportoTotale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.trasportoTotale' | translate }}" [(ngModel)]="wQuote.trasportoTotale" readonly>
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('costoImballoValore')" for="costoImballoValore">{{ 'APP.FIELD.costoImballoValore' | translate }}</label>
                              <input type="number" name="costoImballoValore" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.costoImballoValore' | translate }}" [(ngModel)]="wQuote.costoImballoValore">
                            </div>
                            <div class="form-group col-1 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('costoImballoPercentuale')" for="costoImballoPercentuale">{{ 'APP.FIELD.costoImballoPercentuale' | translate }}</label>
                              <input type="number" name="costoImballoPercentuale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.costoImballoPercentuale' | translate }}" [(ngModel)]="wQuote.costoImballoPercentuale">
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('imballoTotale')" for="imballoTotale">{{ 'APP.FIELD.imballoTotale' | translate }}</label>
                              <input type="number" name="imballoTotale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.imballoTotale' | translate }}" [(ngModel)]="wQuote.imballoTotale" readonly>
                            </div>
                          </div>
                          <div class="form-row align-items-center">
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('speseIncassoValore')" for="speseIncassoValore">{{ 'APP.FIELD.speseIncassoValore' | translate }}</label>
                              <input type="number" name="speseIncassoValore" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.speseIncassoValore' | translate }}" [(ngModel)]="wQuote.speseIncassoValore">
                            </div>
                            <div class="form-group col-1 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('speseIncassoPercentuale')" for="speseIncassoPercentuale">{{ 'APP.FIELD.speseIncassoPercentuale' | translate }}</label>
                              <input type="number" name="speseIncassoPercentuale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.speseIncassoPercentuale' | translate }}" [(ngModel)]="wQuote.speseIncassoPercentuale">
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('speseIncassoTotale')" for="speseIncassoTotale">{{ 'APP.FIELD.speseIncassoTotale' | translate }}</label>
                              <input type="number" name="speseIncassoTotale" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.speseIncassoTotale' | translate }}" [(ngModel)]="wQuote.speseIncassoTotale" readonly>
                            </div>
                          </div>
                          <div class="form-row align-items-center">
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('anagValutaId')" for="anagValutaId">{{ 'APP.FIELD.anagValutaId' | translate }}</label>
                              <select name="anagValutaId" class="form-control form-control-sm" [(ngModel)]="wQuote.anagValutaId">
                                <option value="0">&nbsp;</option>
                                <option [value]="currencie.id" *ngFor="let currencie of anagraficheCombo['SpComboValuta'];">{{ currencie.descrizione }}</option>
                              </select>
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('cambio')" for="cambio">{{ 'APP.FIELD.cambio' | translate }}</label>
                              <input type="number" name="cambio" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.cambio' | translate }}" [(ngModel)]="wQuote.cambio">
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('totaleInValuta')" for="totaleInValuta">{{ 'APP.FIELD.totaleInValuta' | translate }}</label>
                              <input type="number" name="totaleInValuta" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.totaleInValuta' | translate }}" [(ngModel)]="wQuote.totaleInValuta">
                            </div>
                          </div>
                          <div class="form-row align-items-center">
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('totaleNetto')" for="totaleNetto">{{ 'APP.FIELD.totaleNetto' | translate }}</label>
                              <input type="number" name="totaleNetto" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.totaleNetto' | translate }}" [(ngModel)]="wQuote.totaleNetto" readonly>
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('totaleMerce')" for="totaleMerce">{{ 'APP.FIELD.totaleMerce' | translate }}</label>
                              <input type="number" name="totaleMerce" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.totaleMerce' | translate }}" [(ngModel)]="wQuote.totaleMerce" readonly>
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('totaleSconto')" for="totaleSconto">{{ 'APP.FIELD.totaleSconto' | translate }}</label>
                              <input type="number" name="totaleSconto" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.totaleSconto' | translate }}" [(ngModel)]="wQuote.totaleSconto" readonly>
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('totaleIva')" for="totaleIva">{{ 'APP.FIELD.totaleIva' | translate }}</label>
                              <input type="number" name="totaleIva" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.totaleIva' | translate }}" [(ngModel)]="wQuote.totaleIva" readonly>
                            </div>
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('totaleLordo')" for="totaleLordo">{{ 'APP.FIELD.totaleLordo' | translate }}</label>
                              <input type="number" name="totaleLordo" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.totaleLordo' | translate }}" [(ngModel)]="wQuote.totaleLordo" readonly>
                            </div>
                          </div>
                          <div class="form-row align-items-center">
                            <div class="form-group col-9 mt-3 mb-0">
                              <!-- <label class="col-form-label col-form-label-sm">{{ 'APP.TITLE.advances' | translate }}</label> -->
                              <div class="mx-auto border" style="min-height: 120px;" *ngIf="!loading && wQuote && wQuote?.id">
                                <app-advances
                                  [showTitle]="true"
                                  [editable]="true"
                                  [documentoId]="wQuote.id"
                                  [tipoDocumentoId]="wQuote.tipoDocumentoId"
                                  [aziendaId]="wQuote.aziendaId"
                                  [options]="{ height: '150px' }">
                                </app-advances>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  <!-- </mat-tab> -->
                  </div>
                  <div class="container-fluid tab-pane fadeIn pt-3 px-2 px-sm-3" id="other_data" [hidden]="!isTabActive('other_data')">
                  <!-- <mat-tab label="{{ 'APP.TAB.other_data' | translate }}"> -->
                    <div class="card card-client-info mx-auto">
                      <div class="card-body px-2 py-2">
                        <div class="px-0">
                          <!-- <div class="py-5">{{ 'APP.TAB.other_data' | translate }}</div> -->
                          <div class="form-row align-items-center">
                            <div class="form-group col-3 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('ivaTrasportoId')" for="ivaTrasportoId">{{ 'APP.FIELD.ivaTrasporto' | translate }}</label>
                              <ng-select class="form-select-sm"
                                name="ivaTrasportoId"
                                [items]="anagraficheCombo['SpComboIva']"
                                bindValue="id"
                                bindLabel="descrizione"
                                appendTo="body"
                                [searchFn]="customSearchFn"
                                [(ngModel)]="wQuote.ivaTrasportoId"
                                (change)="onFormChanges($event)">
                                  <ng-template ng-option-tmp let-item="item">
                                    {{item.descrizione}} <br/>
                                    <small>{{item.codice}} - {{item.id}}</small>
                                  </ng-template>
                              </ng-select>
                            </div>
                            <div class="form-group col-3 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('ivaSpeseDiIncassoId')" for="ivaSpeseDiIncassoId">{{ 'APP.FIELD.ivaSpeseDiIncasso' | translate }}</label>
                              <ng-select class="form-select-sm"
                                name="ivaSpeseDiIncassoId"
                                [items]="anagraficheCombo['SpComboIva']"
                                bindValue="id"
                                bindLabel="descrizione"
                                appendTo="body"
                                [searchFn]="customSearchFn"
                                [(ngModel)]="wQuote.ivaSpeseDiIncassoId"
                                (change)="onFormChanges($event)">
                                  <ng-template ng-option-tmp let-item="item">
                                    {{item.descrizione}} <br/>
                                    <small>{{item.codice}} - {{item.id}}</small>
                                  </ng-template>
                              </ng-select>
                            </div>
                            <div class="form-group col-3 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('ivaImballoId')" for="ivaImballoId">{{ 'APP.FIELD.ivaImballo' | translate }}</label>
                              <ng-select class="form-select-sm"
                                name="ivaImballoId"
                                [items]="anagraficheCombo['SpComboIva']"
                                bindValue="id"
                                bindLabel="descrizione"
                                appendTo="body"
                                [searchFn]="customSearchFn"
                                [(ngModel)]="wQuote.ivaImballoId"
                                (change)="onFormChanges($event)">
                                  <ng-template ng-option-tmp let-item="item">
                                    {{item.descrizione}} <br/>
                                    <small>{{item.codice}} - {{item.id}}</small>
                                  </ng-template>
                              </ng-select>
                            </div>
                            <div class="form-group col-3 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('ivaDoganaCustomId')" for="ivaDoganaCustomId">{{ 'APP.FIELD.ivaDoganaCustom' | translate }}</label>
                              <ng-select class="form-select-sm"
                                name="ivaDoganaCustomId"
                                [items]="anagraficheCombo['SpComboIva']"
                                bindValue="id"
                                bindLabel="descrizione"
                                appendTo="body"
                                [searchFn]="customSearchFn"
                                [(ngModel)]="wQuote.ivaDoganaCustomId"
                                (change)="onFormChanges($event)">
                                  <ng-template ng-option-tmp let-item="item">
                                    {{item.descrizione}} <br/>
                                    <small>{{item.codice}} - {{item.id}}</small>
                                  </ng-template>
                              </ng-select>
                            </div>
                          </div>
                          <div class="form-row align-items-center">
                            <div class="form-group col-2 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('vettoreId')" for="vettoreId">{{ 'APP.FIELD.vettoreId' | translate }}</label>
                              <input type="text" name="vettoreId" class="form-control form-control-sm mb-1" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.vettoreId" readonly>
                            </div>
                            <div class="form-group input-group input-group-sm col-4 mb-0">
                              <label class="col-form-label col-form-label-sm w-100" [class.modified-]="isModifiedProperty('nominativoVettore')" for="nominativoVettore">{{ 'APP.FIELD.empty' | translate }}&nbsp; <span class="btn btn-sm p-0 float-right" style="font-size: 0.9em;" (click)="openChoiceModal('vettore')"><i class="icon-magnifier"></i></span></label>
                              <input type="text" name="nominativoVettore" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.empty' | translate }}" [(ngModel)]="wQuote.nominativoVettore" readonly>
                              <div class="input-group-append cursor-pointer" (click)="showContact(wQuote.vettoreId, wQuote.nominativoVettore)" *ngIf="wQuote.vettoreId"><span class="input-group-text"><i class="icon-eye"></i></span></div>
                            </div>
                          </div>
                          <div class="form-row align-items-center">
                            <div class="form-group col-3 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('responsabile')" for="responsabile">{{ 'APP.FIELD.responsabile' | translate }}</label>
                              <input type="text" name="responsabile" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.responsabile' | translate }}" [(ngModel)]="wQuote.responsabile" readonly>
                            </div>
                            <div class="form-group col-3 mb-0">
                              <label class="col-form-label col-form-label-sm" [class.modified]="isModifiedProperty('anagLinguaId')" for="anagLinguaId">{{ 'APP.FIELD.lingua' | translate }}</label>
                              <select name="anagLinguaId" class="form-control form-control-sm" [(ngModel)]="wQuote.anagLinguaId">
                                <option value="0">&nbsp;</option>
                                <option [value]="al.id" *ngFor="let al of anagraficheCombo['SpComboLingua'];">{{ al.descrizione }}</option>
                              </select>
                            </div>
                          </div>
                          <div class="form-row align-items-center mt-4">
                            <fieldset class="fieldset-border">
                              <legend class="small">{{ 'Sistema Esterno' | translate }}</legend>
                              <div class="form-group col mb-1 px-0">
                                <label class="form-check-label col-form-label-sm d-block" [class.modified]="isModifiedProperty('isNoExportAltroSistema')" for="isNoExportAltroSistema">{{ 'APP.FIELD.isNoExportAltroSistema' | translate }}</label>
                                <!-- <input type="text" name="isNoExportAltroSistema" class="form-control form-control-sm" placeholder="{{ 'APP.PLACEHOLDER.isNoExportAltroSistema' | translate }}" [(ngModel)]="wQuote.isNoExportAltroSistema"> -->
                                <label class="switch switch-sm switch-3d switch-primary">
                                  <input type="checkbox" name="isNoExportAltroSistema" [checked]="wQuote.isNoExportAltroSistema" class="switch-input" [(ngModel)]="wQuote.isNoExportAltroSistema">
                                  <span class="switch-slider"></span>
                                </label>
                              </div>
                            </fieldset>
                          </div>
                        </div>
                      </div>
                    </div>
                  <!-- </mat-tab> -->
                  </div>
                  <div class="container-fluid tab-pane fadeIn pt-3 px-2 px-sm-3" id="orders" [hidden]="!isTabActive('orders')">
                    <div class="card card-general-info mx-auto layout-2" style="min-height: 200px;" *ngIf="!loading && wQuote && wQuote?.id">
                      <div class="card-body pt-2">
                        <app-quote-orders
                          [quoteId]="wQuote.id"
                          [tipoDocumentoId]="wQuote.tipoDocumentoId"
                          [macroTipoDocumento]="5"
                          [aziendaId]="wQuote.aziendaId"
                        ></app-quote-orders>
                      </div>
                    </div>
                  </div>
                  <div class="container-fluid tab-pane fadeIn pt-3 px-2 px-sm-3" id="orders-suppliers" [hidden]="!isTabActive('orders-suppliers')">
                    <div class="card card-general-info mx-auto layout-2" style="min-height: 200px;" *ngIf="!loading && wQuote && wQuote?.id">
                      <div class="card-body pt-2">
                        <app-quote-orders-suppliers
                          [quoteId]="wQuote.id"
                          [tipoDocumentoId]="wQuote.tipoDocumentoId"
                          [macroTipoDocumento]="5"
                          [aziendaId]="wQuote.aziendaId"
                        ></app-quote-orders-suppliers>
                      </div>
                    </div>
                  </div>
                  <div class="container-fluid tab-pane fadeIn pt-3 px-2 px-sm-3" id="documents-processed" [hidden]="!isTabActive('documents-processed')">
                    <div class="card card-general-info mx-auto layout-2" style="min-height: 200px;" *ngIf="!loading && wQuote && wQuote?.id">
                      <div class="card-body pt-2">
                        <app-quote-documents
                          [quoteId]="wQuote.id"
                          [tipoDocumentoId]="wQuote.tipoDocumentoId"
                          [macroTipoDocumento]="5"
                          [aziendaId]="wQuote.aziendaId"
                        ></app-quote-documents>
                      </div>
                    </div>
                  </div>
                <!-- </mat-tab-group> -->
              </div>
            </div>
          </form>
          <div class="row mb-4" *ngIf="showJsonEditor">
            <div class="col-12">
              <json-editor [options]="editorOptions" [data]="wQuote"></json-editor>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="flex-layout-sidebar sidebar-right inspector-content" [hidden]="!sidebarOpened">
    <!-- <app-help [chapter]="'quote'" [section]="'section'"></app-help> -->
  </div>
</div>
<div class="flex-layout-footer">
  <div class="bg-gray-100-" style="width: 100%;">
    <div class="d-flex flex-row justify-content-between">
      <div class="col-6 pr-0">
        <button class="btn btn-sm btn-light" (click)="closeEdit($event)"><i class="cui-x"></i> {{ 'APP.BUTTON.close' | translate }}</button>
        <button class="btn btn-sm btn-primary" (click)="saveEdit($event)" [disabled]="!modified"><i class="cui-save"></i> {{ 'APP.BUTTON.save' | translate }}</button>
      </div>
      <div class="col-6 pl-0">
      </div>
    </div>
  </div>
</div>
